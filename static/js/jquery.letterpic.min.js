!function(t){var e=function(){var t=this;t.colors=["#F44336","#673AB7","#03A9F4","#4CAF50","#FFEB3B","#FF5722","#607D8B","#E91E63","#3F51B5","#00BCD4","#8BC34A","#FFC107","#795548","#9C27B0","#2196F3","#009688","#CDDC39","#FF9800","#9E9E9E"],t.gradients=[["#E57373","#B71C1C"],["#673AB7","#7E57C2"],["#03A9F4","#039BE5"],["#4CAF50","#43A047"],["#FFEB3B","#F57F17"],["#FF5722","#D84315"],["#607D8B","#455A64"],["#E91E63","#C2185B"],["#3F51B5","#303F9F"],["#00BCD4","#0097A7"],["#8BC34A","#689F38"],["#FFC107","#FFA000"],["#795548","#5D4037"],["#9C27B0","#8E24AA"],["#2196F3","#1976D2"],["#009688","#00796B"],["#CDDC39","#AFB42B"],["#FF9800","#F57C00"],["#9E9E9E","#757575"]],t.font="Arial",t.fontColor="#fff",t.fontStrokeColor="#000",t.fontSize=.45,t.imageOverlayColor="rgba(0, 0, 0, 0)",t.maxInitialsLength=2,t.useGlobalCache=!0,t.images=[];for(var e="patterns",r=8,i=".png",n=1;r>=n;n++)t.images.push(e+"/"+n+i)},r=function(r){function i(t){if(t){var e=t.colors?a.fillTypeColor:t.gradients?a.fillTypeGradient:t.images?a.fillTypeImage:a.fillTypeGradient;return e}return a.fillTypeGradient}function n(t,e,r){function i(t,r){var i;return a.cache[t]||(a.cache[t]={}),a.cache[t][r]?i=a.cache[t][r]:(0===e.length&&(e=o.bgs.slice().reverse()),i=e.pop(),a.cache[t][r]=i),i}function n(t,e,r,i){var n=r*a.settings.fontSize;e.font=n+"px "+a.settings.font,e.textAlign="center";var o=r/2,l=.45*(n+i);a.settings.fontStrokeColor&&(e.shadowColor=a.settings.fontStrokeColor,e.shadowColor="black",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=3),e.fillStyle=a.settings.fontColor,e.fillText(t,o,l)}var o=this;o.bgs=e;var e=[];o.draw=function(e,o,l){var s=i(t.fill,o),c=e[0],f=window.devicePixelRatio,d=f*e.width(),h=f*e.height(),g=c.getContext("2d");g.scale(f,f),e.attr("width",d),e.attr("height",h),r(g,c,s,function(){n(l,g,d,h)}),g.fillStyle=a.settings.imageOverlayColor,g.fillRect(0,0,c.width,c.height)}}var a=this;a.fillTypeColor="color",a.fillTypeGradient="gradient",a.fillTypeImage="image";var o=new e;if(a.settings=t.extend(o,r),a.settings.fill=a.settings.fill||i(r),a.settings.useGlobalCache?(window.letterpicCache||(window.letterpicCache={}),a.cache=window.letterpicCache):a.cache={},a.settings.initial)for(var l in a.settings.initial){a.cache[l]||(a.cache[l]={});var s=a.settings.initial[l];for(var c in s)a.cache[l][c]=s[c]}a.drawProviders={},a.drawProviders[a.fillTypeColor]=function(t){return new n(t,t.colors,function(t,e,r,i){t.fillStyle=r,t.fillRect(0,0,e.width,e.height),i()})},a.drawProviders[a.fillTypeGradient]=function(t){return new n(t,t.gradients,function(t,e,r,i){var n=r,a=t.createLinearGradient(0,0,0,e.height);a.addColorStop(0,n[0]);for(var o=1/(n.length-1),l=1;l<n.length-1;l++)a.addColorStop(l*o,n[l]);a.addColorStop(1,n[n.length-1]),t.fillStyle=a,t.fillRect(0,0,e.width,e.height),i()})},a.drawProviders[a.fillTypeImage]=function(t){return new n(t,t.images,function(t,e,r,i){var n=new Image;n.onload=function(){t.drawImage(n,0,0,e.width,e.height),i()},n.src=r})},a.drawProvider=a.drawProviders[a.settings.fill](a.settings)};t.fn.letterpic=function(e){function i(t){var e=t.data().letterpicKey||t.data().letterpicUserId||t.data().userid||n(t);return e}function n(t){for(var e=t.attr("title"),r=e.split(" "),i=r[0].charAt(0).toUpperCase(),n=1;n<c.settings.maxInitialsLength;n++)r.length>n&&(i+=r[n].charAt(0).toUpperCase());return i}function a(t){return!t.complete||"undefined"!=typeof t.naturalWidth&&0===t.naturalWidth?!1:!0}function o(e){var r=t(e.target);r.off("error",o),l(r,!0),s.options.onImageError&&s.options.onImageError($canvas,r.attr("src"))}function l(e,r){var a;e.is("canvas")?a=e:(a=t("<canvas></canvas>"),t.each(e[0].attributes,function(t,e){a.attr(e.name,e.value)}),e.replaceWith(a));var o=i(a),l=n(a);return c.drawProvider.draw(a,o,l),s.$letterpics.push(a),s.options.onElementReplaced&&(r=r||!1,s.options.onElementReplaced(a,r)),a}var s=this;s.$letterpics=[],s.options=e||{};var c=new r(e);return this.each(function(){var e=t(this);if(e.is("img"))if(a(e[0]))e.on("error",o);else{var r=l(e);s.options.onImageError&&s.options.onImageError(r,e.attr("src"))}else l(e)}),t(t.map(s.$letterpics,function(t){return t.get()}))}}(jQuery);